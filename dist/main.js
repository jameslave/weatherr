!function t(e,n,r){function o(c,a){if(!n[c]){if(!e[c]){var u="function"==typeof require&&require;if(!a&&u)return u(c,!0);if(i)return i(c,!0);throw new Error("Cannot find module '"+c+"'")}var s=n[c]={exports:{}};e[c][0].call(s.exports,function(t){var n=e[c][1][t];return o(n?n:t)},s,s.exports,t,e,n,r)}return n[c].exports}for(var i="function"==typeof require&&require,c=0;c<r.length;c++)o(r[c]);return o}({1:[function(t,e,n){"use strict";var r=t("./refresh");t("./settings-menu"),document.getElementById("refresh-icon").addEventListener("click",function(){r()}),r()},{"./refresh":5,"./settings-menu":6}],2:[function(t,e,n){"use strict";function r(t){document.getElementById("location").innerText=t.loc}function o(t){var e=document.getElementById("temp"),n=document.cookie?document.cookie.match(/temp=(f|c)/)[1]||"f":"f";e.innerText=t[n]+" °"+n.toUpperCase()}function i(t,e){var n=document.getElementById("forecast-hours"),r=document.getElementById("forecast-temp-text"),o=document.getElementById("forecast-wind-text"),i=document.getElementById("forecast-precip-text");n.innerText=e,r.innerText=t.tempStr,o.innerText=t.windStr,i.innerText=t.precipStr}function c(t){var e=document.getElementsByTagName("main")[0],n="img/backgrounds/"+t.maxForecast+".jpg",r="url('"+n+"') no-repeat center center";e.style.background="linear-gradient(rgba(0,0,0,0.4),rgba(0,0,0,0.4)), "+r}function a(t){document.getElementById("current-icon").setAttribute("src","img/icons/"+t.icon+".svg")}n.inject=function(t,e){return new Promise(function(n){window.weather=t,r(t),a(t),o(t),i(t,e),c(t),n()})}},{}],3:[function(t,e,n){"use strict";n.get=function(){return new Promise(function(t,e){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){t({lat:e.coords.latitude,lon:e.coords.longitude})}):e(Error("Browser does not support geolocation"))})},n.send=function(t){return new Promise(function(e,n){var r=new XMLHttpRequest;r.open("POST","location",!0),r.setRequestHeader("Content-Type","application/json"),r.send(JSON.stringify(t)),r.onerror=function(){n(Error("Connection to server failed"))},r.onreadystatechange=function(){4===r.readyState&&200===r.status&&e(JSON.parse(r.responseText))}})}},{}],4:[function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(t,e,n){return t>=e&&t<n}function i(t,e){var n=parseInt(t.current_observation.feelslike_f),r=t.hourly_forecast.slice(0,e).map(function(t){return parseInt(t.temp.english)}),o=r.reduce(function(t,e){return t+e})/e,i=o-n,c={2:"very cold",3:"cold",4:"chilly",5:"cool",6:"nice",7:"really nice",8:"hot",9:"very hot"},a=function(t){var e=Math.floor(t/10);return e<2?c[2]:e>9?c[9]:c[e]}(n),u=function(t){return t>8?"get much warmer":t>3?"get warmer":Math.abs(t)<=3?"stay "+a:t<-3?"get cooler":"get much cooler"}(i),s="It's going to ";return s+=u,s+="."}function c(t,e){var n=parseInt(t.current_observation.wind_mph),r=t.hourly_forecast.slice(0,e).map(function(t){return parseInt(t.wspd.english)}),i=r.reduce(function(t,e){return t+e})/e,c=i-n,a=function(t){return t>=20?"really windy":o(t,10,20)?"windy":o(t,5,10)?"breezy":"calm"}(n),u=function(t){return t>10?"get much windier":t>5?"get windier":Math.abs(t)<=5?"stay "+a:t<-5?"get calmer":"get much calmer"}(c),s="It's going to ";return s+=u,s+="."}function a(t,e){var n=t.hourly_forecast.slice(0,e),i=n.map(function(t){return parseInt(t.pop)}),c=n.map(function(t){return parseInt(t.fctcode)}),a=Math.max.apply(Math,r(i)),u=Math.max.apply(Math,r(c));[10,12,14,18,20,22].includes(u)&&u++;var s=function(t){return t>=80?"It will be wet":o(t,40,80)?"There's a good chance of precipitation":o(t,10,40)?"There's a slight chance of precipitation":"It will be dry"}(a),f=s;return f+=".",{maxForecast:u,str:f}}n.parse=function(t,e){return new Promise(function(n){var r={},o=t.current_observation.icon_url.match(/\w\/(\w+).gif$/)[1];r.loc=t.current_observation.display_location.city,r.icon=o,r.f=t.current_observation.feelslike_f,r.c=t.current_observation.feelslike_c,r.tempStr=i(t,e),r.windStr=c(t,e);var u=a(t,e);r.precipStr=u.str,r.maxForecast=u.maxForecast,n(r)})}},{}],5:[function(t,e,n){"use strict";function r(){return new Promise(function(t){f.classList.add("animate-spin"),t()})}function o(){return new Promise(function(t){s.classList.add("animate-fade"),f.classList.remove("animate-spin"),f.classList.contains("hidden")&&f.classList.remove("hidden"),t()})}var i=t("./location"),c=t("./parser"),a=t("./injector"),u=document.cookie?document.cookie.match(/hours=(\d{1,2})/)[1]||8:8,s=document.getElementById("loading-screen"),f=document.getElementById("refresh-icon");e.exports=function(){r().then(function(){return i.get()}).then(function(t){return i.send(t)}).then(function(t){return c.parse(t,u)}).then(function(t){return a.inject(t,u)}).then(function(){return o()})}},{"./injector":2,"./location":3,"./parser":4}],6:[function(t,e,n){"use strict";function r(){return"0px"!==u.css("max-height")}function o(){s.animate({opacity:0},250,function(){u.animate({"max-height":"0px"},500)})}function i(){var t=a.position().left+a.width();u.css("left",t-u.width()),u.animate({"max-height":"100px"},500,function(){s.animate({opacity:1},250)})}function c(t){return!t.hasClass("selected")}var a=$("#settings-icon"),u=$("#settings-menu"),s=$("#temp-toggle"),f=$(".toggle-item"),l=$("#temp");a.on("click",function(){r()?o():i()}),$(document).ready(function(){var t=void 0;try{t=document.cookie.match(/temp=(f|c)/)[1]}catch(e){t="f"}$("[data-units='"+t+"']").addClass("selected")}),f.on("click",function(t){var e=$(t.target);if(c(e)){var n=e.attr("data-units");f.toggleClass("selected"),document.cookie="temp="+n,l.text(window.weather[n]+" °"+n.toUpperCase()),o()}})},{}]},{},[1]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZSIsInQiLCJuIiwiciIsInMiLCJvIiwidSIsImEiLCJyZXF1aXJlIiwiaSIsIkVycm9yIiwiZiIsImV4cG9ydHMiLCJjYWxsIiwibGVuZ3RoIiwiMSIsIm1vZHVsZSIsInJlZnJlc2giLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiYWRkRXZlbnRMaXN0ZW5lciIsIi4vcmVmcmVzaCIsIi4vc2V0dGluZ3MtbWVudSIsIjIiLCJzZXRMb2NhdGlvbiIsImRhdGEiLCJpbm5lclRleHQiLCJsb2MiLCJzZXRUZW1wIiwidGVtcCIsInRlbXBQcmVmIiwiY29va2llIiwibWF0Y2giLCJ0b1VwcGVyQ2FzZSIsInNldEZvcmVjYXN0IiwiaG91cnNBaGVhZCIsImZvcmVjYXN0SG91cnMiLCJmb3JlY2FzdFRlbXBUZXh0IiwiZm9yZWNhc3RXaW5kVGV4dCIsImZvcmVjYXN0UHJlY2lwVGV4dCIsInRlbXBTdHIiLCJ3aW5kU3RyIiwicHJlY2lwU3RyIiwic2V0QmFja2dyb3VuZCIsIm1haW4iLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsImltZyIsIm1heEZvcmVjYXN0IiwidXJsIiwic3R5bGUiLCJiYWNrZ3JvdW5kIiwiZ3JhZGllbnQiLCJzZXRJY29uIiwic2V0QXR0cmlidXRlIiwiaWNvbiIsImluamVjdCIsIlByb21pc2UiLCJyZXNvbHZlIiwid2luZG93Iiwid2VhdGhlciIsIjMiLCJnZXQiLCJyZWplY3QiLCJuYXZpZ2F0b3IiLCJnZW9sb2NhdGlvbiIsImdldEN1cnJlbnRQb3NpdGlvbiIsInBvcyIsImxhdCIsImNvb3JkcyIsImxhdGl0dWRlIiwibG9uIiwibG9uZ2l0dWRlIiwic2VuZCIsImNvb3Jkc09iaiIsInJlcSIsIlhNTEh0dHBSZXF1ZXN0Iiwib3BlbiIsInNldFJlcXVlc3RIZWFkZXIiLCJKU09OIiwic3RyaW5naWZ5Iiwib25lcnJvciIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsInJlYWR5U3RhdGUiLCJzdGF0dXMiLCJwYXJzZSIsInJlc3BvbnNlVGV4dCIsIjQiLCJfdG9Db25zdW1hYmxlQXJyYXkiLCJhcnIiLCJBcnJheSIsImlzQXJyYXkiLCJhcnIyIiwiZnJvbSIsImJldHdlZW4iLCJsZXRpYWJsZSIsIngwIiwieDEiLCJmb3JtYXRUZW1wIiwianNvbiIsImN1cnJlbnRUZW1wIiwicGFyc2VJbnQiLCJjdXJyZW50X29ic2VydmF0aW9uIiwiZmVlbHNsaWtlX2YiLCJmdXR1cmVUZW1wcyIsImhvdXJseV9mb3JlY2FzdCIsInNsaWNlIiwibWFwIiwiaG91ciIsImVuZ2xpc2giLCJtZWFuRnV0dXJlVGVtcCIsInJlZHVjZSIsImIiLCJ0ZW1wRGlmZiIsInRlbXBTdHJzIiwiNSIsIjYiLCI3IiwiOCIsIjkiLCJjdXJyZW50RGVzYyIsImluZGV4IiwiTWF0aCIsImZsb29yIiwiZnV0dXJlRGVzYyIsImRpZmYiLCJhYnMiLCJjb25jYXRUZW1wIiwiZm9ybWF0V2luZCIsImN1cnJlbnRXaW5kIiwid2luZF9tcGgiLCJmdXR1cmVXaW5kcyIsIndzcGQiLCJtZWFuRnV0dXJlV2luZCIsIndpbmREaWZmIiwid2luZCIsImNvbmNhdFdpbmQiLCJmb3JtYXRQcmVjaXAiLCJmdXR1cmVIb3VycyIsImZ1dHVyZVByb2JzIiwicG9wIiwiZnV0dXJlQ29kZXMiLCJmY3Rjb2RlIiwibWF4UHJlY2lwUHJvYiIsIm1heCIsImFwcGx5IiwibWF4Rm9yZWNhc3RDb2RlIiwiaW5jbHVkZXMiLCJwcm9iIiwiY29uY2F0UHJlY2lwIiwic3RyIiwid2VhdGhlckRhdGEiLCJpY29uX3VybCIsImRpc3BsYXlfbG9jYXRpb24iLCJjaXR5IiwiYyIsImZlZWxzbGlrZV9jIiwicHJlY2lwT2JqIiwic2hvd0xvYWRpbmciLCJyZWZyZXNoSWNvbiIsImNsYXNzTGlzdCIsImFkZCIsImhpZGVMb2FkaW5nIiwibG9hZGluZ1NjcmVlbiIsInJlbW92ZSIsImNvbnRhaW5zIiwibG9jYXRpb24iLCJwYXJzZXIiLCJpbmplY3RvciIsInRoZW4iLCIuL2luamVjdG9yIiwiLi9sb2NhdGlvbiIsIi4vcGFyc2VyIiwic2V0dGluZ3NBcmVWaXNpYmxlIiwiJHNldHRpbmdzTWVudSIsImNzcyIsImhpZGVTZXR0aW5ncyIsIiR0ZW1wVG9nZ2xlIiwiYW5pbWF0ZSIsIm9wYWNpdHkiLCJtYXgtaGVpZ2h0Iiwic2hvd1NldHRpbmdzIiwiaWNvblJpZ2h0UG9zaXRpb24iLCIkc2V0dGluZ3NJY29uIiwicG9zaXRpb24iLCJsZWZ0Iiwid2lkdGgiLCJvcHRpb25Jc05vdFNlbGVjdGVkIiwidGFyZ2V0IiwiaGFzQ2xhc3MiLCIkIiwiJHRvZ2dsZUl0ZW1zIiwiJHRlbXAiLCJvbiIsInJlYWR5IiwiYWRkQ2xhc3MiLCIkdGFyZ2V0IiwidW5pdHMiLCJhdHRyIiwidG9nZ2xlQ2xhc3MiLCJ0ZXh0Il0sIm1hcHBpbmdzIjoiQ0FBQSxRQUFVQSxHQUFFQyxFQUFFQyxFQUFFQyxHQUFHLFFBQVNDLEdBQUVDLEVBQUVDLEdBQUcsSUFBSUosRUFBRUcsR0FBRyxDQUFDLElBQUlKLEVBQUVJLEdBQUcsQ0FBQyxHQUFJRSxHQUFrQixrQkFBVEMsVUFBcUJBLE9BQVEsS0FBSUYsR0FBR0MsRUFBRSxNQUFPQSxHQUFFRixHQUFFLEVBQUksSUFBR0ksRUFBRSxNQUFPQSxHQUFFSixHQUFFLEVBQUksTUFBTSxJQUFJSyxPQUFNLHVCQUF1QkwsRUFBRSxLQUFLLEdBQUlNLEdBQUVULEVBQUVHLElBQUlPLFdBQVlYLEdBQUVJLEdBQUcsR0FBR1EsS0FBS0YsRUFBRUMsUUFBUSxTQUFTWixHQUFHLEdBQUlFLEdBQUVELEVBQUVJLEdBQUcsR0FBR0wsRUFBRyxPQUFPSSxHQUFFRixFQUFFQSxFQUFFRixJQUFJVyxFQUFFQSxFQUFFQyxRQUFRWixFQUFFQyxFQUFFQyxFQUFFQyxHQUFHLE1BQU9ELEdBQUVHLEdBQUdPLFFBQWtELElBQUksR0FBMUNILEdBQWtCLGtCQUFURCxVQUFxQkEsUUFBZ0JILEVBQUUsRUFBRUEsRUFBRUYsRUFBRVcsT0FBT1QsSUFBSUQsRUFBRUQsRUFBRUUsR0FBSSxP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S0FBSzdJLE9BQU9DLFFBQVF5SSxHQUFTLEtBQU9BLEVBQU1uSyxlQUNoRDhJLGlCQTRCTyIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpfXZhciBmPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChmLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGYsZi5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkoezE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG4vLyBkb2N1bWVudC5jb29raWUgPSAndGVtcD1mJ1xuLy8gZG9jdW1lbnQuY29va2llID0gJ2hvdXJzPTgnXG5cbnZhciByZWZyZXNoID0gcmVxdWlyZSgnLi9yZWZyZXNoJyk7XG5yZXF1aXJlKCcuL3NldHRpbmdzLW1lbnUnKTtcblxudmFyIHJlZnJlc2hJY29uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlZnJlc2gtaWNvbicpO1xuXG5yZWZyZXNoSWNvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgcmVmcmVzaCgpO1xufSk7XG5cbi8vIFJlZnJlc2ggb24gcGFnZSBsb2FkXG5yZWZyZXNoKCk7XG59LHtcIi4vcmVmcmVzaFwiOjUsXCIuL3NldHRpbmdzLW1lbnVcIjo2fV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIHNldExvY2F0aW9uKGRhdGEpIHtcbiAgdmFyIGxvY2F0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvY2F0aW9uJyk7XG4gIGxvY2F0aW9uLmlubmVyVGV4dCA9IGRhdGEubG9jO1xufVxuXG5mdW5jdGlvbiBzZXRUZW1wKGRhdGEpIHtcbiAgdmFyIHRlbXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGVtcCcpO1xuICAvLyBjaGVjayBmb3IgZXhpc3RlbmNlIG9mIGNvb2tpZVxuICAvLyB0aGVuIHNldCBpdCBlaXRoZXIgdG8gdXNlciBwcmVmZXJlbmNlIG9yICdmJ1xuICB2YXIgdGVtcFByZWYgPSBkb2N1bWVudC5jb29raWUgPyBkb2N1bWVudC5jb29raWUubWF0Y2goL3RlbXA9KGZ8YykvKVsxXSB8fCAnZicgOiAnZic7XG4gIHRlbXAuaW5uZXJUZXh0ID0gZGF0YVt0ZW1wUHJlZl0gKyAnIFxceEIwJyArIHRlbXBQcmVmLnRvVXBwZXJDYXNlKCk7XG59XG5cbmZ1bmN0aW9uIHNldEZvcmVjYXN0KGRhdGEsIGhvdXJzQWhlYWQpIHtcbiAgdmFyIGZvcmVjYXN0SG91cnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9yZWNhc3QtaG91cnMnKTtcbiAgdmFyIGZvcmVjYXN0VGVtcFRleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9yZWNhc3QtdGVtcC10ZXh0Jyk7XG4gIHZhciBmb3JlY2FzdFdpbmRUZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZvcmVjYXN0LXdpbmQtdGV4dCcpO1xuICB2YXIgZm9yZWNhc3RQcmVjaXBUZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZvcmVjYXN0LXByZWNpcC10ZXh0Jyk7XG5cbiAgZm9yZWNhc3RIb3Vycy5pbm5lclRleHQgPSBob3Vyc0FoZWFkO1xuICBmb3JlY2FzdFRlbXBUZXh0LmlubmVyVGV4dCA9IGRhdGEudGVtcFN0cjtcbiAgZm9yZWNhc3RXaW5kVGV4dC5pbm5lclRleHQgPSBkYXRhLndpbmRTdHI7XG4gIGZvcmVjYXN0UHJlY2lwVGV4dC5pbm5lclRleHQgPSBkYXRhLnByZWNpcFN0cjtcbn1cblxuZnVuY3Rpb24gc2V0QmFja2dyb3VuZChkYXRhKSB7XG4gIHZhciBtYWluID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ21haW4nKVswXTtcbiAgdmFyIGdyYWRpZW50ID0gJ2xpbmVhci1ncmFkaWVudChyZ2JhKDAsMCwwLDAuNCkscmdiYSgwLDAsMCwwLjQpKSc7XG4gIHZhciBpbWcgPSAnaW1nL2JhY2tncm91bmRzLycgKyBkYXRhLm1heEZvcmVjYXN0ICsgJy5qcGcnO1xuICB2YXIgdXJsID0gJ3VybChcXCcnICsgaW1nICsgJ1xcJykgbm8tcmVwZWF0IGNlbnRlciBjZW50ZXInO1xuICBtYWluLnN0eWxlLmJhY2tncm91bmQgPSBncmFkaWVudCArICcsICcgKyB1cmw7XG59XG5cbmZ1bmN0aW9uIHNldEljb24oZGF0YSkge1xuICB2YXIgY3VycmVudEljb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3VycmVudC1pY29uJyk7XG4gIGN1cnJlbnRJY29uLnNldEF0dHJpYnV0ZSgnc3JjJywgJ2ltZy9pY29ucy8nICsgZGF0YS5pY29uICsgJy5zdmcnKTtcbn1cblxuZXhwb3J0cy5pbmplY3QgPSBmdW5jdGlvbiAoZGF0YSwgaG91cnNBaGVhZCkge1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICB3aW5kb3cud2VhdGhlciA9IGRhdGE7XG4gICAgc2V0TG9jYXRpb24oZGF0YSk7XG4gICAgc2V0SWNvbihkYXRhKTtcbiAgICBzZXRUZW1wKGRhdGEpO1xuICAgIHNldEZvcmVjYXN0KGRhdGEsIGhvdXJzQWhlYWQpO1xuICAgIHNldEJhY2tncm91bmQoZGF0YSk7XG4gICAgcmVzb2x2ZSgpO1xuICB9KTtcbn07XG59LHt9XSwzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuLyogZ2xvYmFsIFhNTEh0dHBSZXF1ZXN0ICovXG5cbmV4cG9ydHMuZ2V0ID0gZnVuY3Rpb24gKCkge1xuICAvLyBwcm9taXNlIHJldHVybnMgdXNlciBsb2NhdGlvbiB3aGVuIGl0J3MgZGV0ZXJtaW5lZFxuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgIC8vIGlmIGJyb3dzZXIgY2FuIGdldCB1c2VyJ3MgbG9jYXRpb25cbiAgICBpZiAobmF2aWdhdG9yLmdlb2xvY2F0aW9uKSB7XG4gICAgICBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKGZ1bmN0aW9uIChwb3MpIHtcbiAgICAgICAgcmVzb2x2ZSh7IGxhdDogcG9zLmNvb3Jkcy5sYXRpdHVkZSwgbG9uOiBwb3MuY29vcmRzLmxvbmdpdHVkZSB9KTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZWplY3QoRXJyb3IoJ0Jyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCBnZW9sb2NhdGlvbicpKTtcbiAgICB9XG4gIH0pO1xufTtcblxuZXhwb3J0cy5zZW5kID0gZnVuY3Rpb24gKGNvb3Jkc09iaikge1xuICAvLyBwcm9taXNlIHJldHVybnMgc2VydmVyIHJlc3BvbnNlIHdoZW4gaXQncyByZWNlaXZlZFxuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgIC8vIFBPU1QgdXNlcidzIGxvY2F0aW9uIHRvIHRoZSBzZXJ2ZXIsIHdoaWNoIHdpbGwgbWFrZSB0aGUgQVBJIGNhbGxcbiAgICB2YXIgcmVxID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cbiAgICByZXEub3BlbignUE9TVCcsICdsb2NhdGlvbicsIHRydWUpO1xuICAgIHJlcS5zZXRSZXF1ZXN0SGVhZGVyKCdDb250ZW50LVR5cGUnLCAnYXBwbGljYXRpb24vanNvbicpO1xuICAgIHJlcS5zZW5kKEpTT04uc3RyaW5naWZ5KGNvb3Jkc09iaikpO1xuXG4gICAgcmVxLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZWplY3QoRXJyb3IoJ0Nvbm5lY3Rpb24gdG8gc2VydmVyIGZhaWxlZCcpKTtcbiAgICB9O1xuICAgIHJlcS5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAocmVxLnJlYWR5U3RhdGUgPT09IDQgJiYgcmVxLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgIC8vIHJlc29sdmUgcHJvbWlzZSBpZiByZXF1ZXN0IGlzIGNvbXBsZXRlIGFuZCBPS1xuICAgICAgICByZXNvbHZlKEpTT04ucGFyc2UocmVxLnJlc3BvbnNlVGV4dCkpO1xuICAgICAgfVxuICAgIH07XG4gIH0pO1xufTtcbn0se31dLDQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgeyBhcnIyW2ldID0gYXJyW2ldOyB9IHJldHVybiBhcnIyOyB9IGVsc2UgeyByZXR1cm4gQXJyYXkuZnJvbShhcnIpOyB9IH1cblxuLy8gaGVscGVyIGZ1bmN0aW9uIHRvIGNoZWNrIGlmIHZhcmlhYmxlIGlzIGluIHJhbmdlXG5mdW5jdGlvbiBiZXR3ZWVuKGxldGlhYmxlLCB4MCwgeDEpIHtcbiAgcmV0dXJuIGxldGlhYmxlID49IHgwICYmIGxldGlhYmxlIDwgeDE7XG59XG5cbi8vIGZvcm1hdHMgdGVtcGVyYXR1cmUgYXMgYSBkZXNjcmlwdGl2ZSBzdHJpbmdcbmZ1bmN0aW9uIGZvcm1hdFRlbXAoanNvbiwgaG91cnNBaGVhZCkge1xuICB2YXIgY3VycmVudFRlbXAgPSBwYXJzZUludChqc29uLmN1cnJlbnRfb2JzZXJ2YXRpb24uZmVlbHNsaWtlX2YpO1xuICB2YXIgZnV0dXJlVGVtcHMgPSBqc29uLmhvdXJseV9mb3JlY2FzdC5zbGljZSgwLCBob3Vyc0FoZWFkKS5tYXAoZnVuY3Rpb24gKGhvdXIpIHtcbiAgICByZXR1cm4gcGFyc2VJbnQoaG91ci50ZW1wLmVuZ2xpc2gpO1xuICB9KTtcbiAgdmFyIG1lYW5GdXR1cmVUZW1wID0gZnV0dXJlVGVtcHMucmVkdWNlKGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgcmV0dXJuIGEgKyBiO1xuICB9KSAvIGhvdXJzQWhlYWQ7XG4gIHZhciB0ZW1wRGlmZiA9IG1lYW5GdXR1cmVUZW1wIC0gY3VycmVudFRlbXA7XG5cbiAgdmFyIHRlbXBTdHJzID0ge1xuICAgIDI6ICd2ZXJ5IGNvbGQnLFxuICAgIDM6ICdjb2xkJyxcbiAgICA0OiAnY2hpbGx5JyxcbiAgICA1OiAnY29vbCcsXG4gICAgNjogJ25pY2UnLFxuICAgIDc6ICdyZWFsbHkgbmljZScsXG4gICAgODogJ2hvdCcsXG4gICAgOTogJ3ZlcnkgaG90J1xuICB9O1xuXG4gIHZhciBjdXJyZW50RGVzYyA9IGZ1bmN0aW9uICh0ZW1wKSB7XG4gICAgdmFyIGluZGV4ID0gTWF0aC5mbG9vcih0ZW1wIC8gMTApO1xuICAgIGlmIChpbmRleCA8IDIpIHJldHVybiB0ZW1wU3Ryc1syXTtcbiAgICBpZiAoaW5kZXggPiA5KSByZXR1cm4gdGVtcFN0cnNbOV07XG4gICAgcmV0dXJuIHRlbXBTdHJzW2luZGV4XTtcbiAgfShjdXJyZW50VGVtcCk7XG5cbiAgdmFyIGZ1dHVyZURlc2MgPSBmdW5jdGlvbiAoZGlmZikge1xuICAgIGlmIChkaWZmID4gOCkgcmV0dXJuICdnZXQgbXVjaCB3YXJtZXInO1xuICAgIGlmIChkaWZmID4gMykgcmV0dXJuICdnZXQgd2FybWVyJztcbiAgICBpZiAoTWF0aC5hYnMoZGlmZikgPD0gMykgcmV0dXJuICdzdGF5ICcgKyBjdXJyZW50RGVzYztcbiAgICBpZiAoZGlmZiA8IC0zKSByZXR1cm4gJ2dldCBjb29sZXInO1xuICAgIHJldHVybiAnZ2V0IG11Y2ggY29vbGVyJztcbiAgfSh0ZW1wRGlmZik7XG5cbiAgdmFyIGNvbmNhdFRlbXAgPSAnSXRcXCdzIGdvaW5nIHRvICc7XG4gIGNvbmNhdFRlbXAgKz0gZnV0dXJlRGVzYztcbiAgY29uY2F0VGVtcCArPSAnLic7XG5cbiAgcmV0dXJuIGNvbmNhdFRlbXA7XG59XG5cbi8vIGZvcm1hdHMgd2luZCBhcyBhIGRlc2NyaXB0aXZlIHN0cmluZ1xuZnVuY3Rpb24gZm9ybWF0V2luZChqc29uLCBob3Vyc0FoZWFkKSB7XG4gIHZhciBjdXJyZW50V2luZCA9IHBhcnNlSW50KGpzb24uY3VycmVudF9vYnNlcnZhdGlvbi53aW5kX21waCk7XG4gIHZhciBmdXR1cmVXaW5kcyA9IGpzb24uaG91cmx5X2ZvcmVjYXN0LnNsaWNlKDAsIGhvdXJzQWhlYWQpLm1hcChmdW5jdGlvbiAoaG91cikge1xuICAgIHJldHVybiBwYXJzZUludChob3VyLndzcGQuZW5nbGlzaCk7XG4gIH0pO1xuICB2YXIgbWVhbkZ1dHVyZVdpbmQgPSBmdXR1cmVXaW5kcy5yZWR1Y2UoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICByZXR1cm4gYSArIGI7XG4gIH0pIC8gaG91cnNBaGVhZDtcbiAgdmFyIHdpbmREaWZmID0gbWVhbkZ1dHVyZVdpbmQgLSBjdXJyZW50V2luZDtcblxuICB2YXIgY3VycmVudERlc2MgPSBmdW5jdGlvbiAod2luZCkge1xuICAgIGlmICh3aW5kID49IDIwLjApIHJldHVybiAncmVhbGx5IHdpbmR5JztcbiAgICBpZiAoYmV0d2Vlbih3aW5kLCAxMC4wLCAyMC4wKSkgcmV0dXJuICd3aW5keSc7XG4gICAgaWYgKGJldHdlZW4od2luZCwgNS4wLCAxMC4wKSkgcmV0dXJuICdicmVlenknO1xuICAgIHJldHVybiAnY2FsbSc7XG4gIH0oY3VycmVudFdpbmQpO1xuXG4gIHZhciBmdXR1cmVEZXNjID0gZnVuY3Rpb24gKGRpZmYpIHtcbiAgICBpZiAoZGlmZiA+IDEwLjApIHJldHVybiAnZ2V0IG11Y2ggd2luZGllcic7XG4gICAgaWYgKGRpZmYgPiA1LjApIHJldHVybiAnZ2V0IHdpbmRpZXInO1xuICAgIGlmIChNYXRoLmFicyhkaWZmKSA8PSA1LjApIHJldHVybiAnc3RheSAnICsgY3VycmVudERlc2M7XG4gICAgaWYgKGRpZmYgPCAtNS4wKSByZXR1cm4gJ2dldCBjYWxtZXInO1xuICAgIHJldHVybiAnZ2V0IG11Y2ggY2FsbWVyJztcbiAgfSh3aW5kRGlmZik7XG5cbiAgdmFyIGNvbmNhdFdpbmQgPSAnSXRcXCdzIGdvaW5nIHRvICc7XG4gIGNvbmNhdFdpbmQgKz0gZnV0dXJlRGVzYztcbiAgY29uY2F0V2luZCArPSAnLic7XG5cbiAgcmV0dXJuIGNvbmNhdFdpbmQ7XG59XG5cbi8vIGZvcm1hdHMgcHJlY2lwaXRhdGlvbiBhcyBhIGRlc2NyaXB0aXZlIHN0cmluZ1xuZnVuY3Rpb24gZm9ybWF0UHJlY2lwKGpzb24sIGhvdXJzQWhlYWQpIHtcbiAgLyogRmluZCBtYXggcHJlY2lwIHByb2JhYmlsaXR5IGFuZCBtYXggZm9yZWNhc3QgY29kZSBhcyBnaXZlbiBhdFxyXG4gICAgIGh0dHA6Ly93d3cud3VuZGVyZ3JvdW5kLmNvbS93ZWF0aGVyL2FwaS9kL2RvY3M/ZD1yZXNvdXJjZXMvcGhyYXNlLWdsb3NzYXJ5LlxyXG4gICAgIFRoaXMgY2FuIGJlIGNvcnJlbGF0ZWQgd2l0aCBjbGVhci9yYWluL3Nub3cuXHJcbiAgKi9cblxuICB2YXIgZnV0dXJlSG91cnMgPSBqc29uLmhvdXJseV9mb3JlY2FzdC5zbGljZSgwLCBob3Vyc0FoZWFkKTtcblxuICAvLyBnZXQgZnV0dXJlIHByb2JhYmlsaXRpZXMgb2YgcHJlY2lwaXRhdGlvblxuICB2YXIgZnV0dXJlUHJvYnMgPSBmdXR1cmVIb3Vycy5tYXAoZnVuY3Rpb24gKGhvdXIpIHtcbiAgICByZXR1cm4gcGFyc2VJbnQoaG91ci5wb3ApO1xuICB9KTtcbiAgLy8gYW5kIGZ1dHVyZSBmb3JlY2FzdCBjb2Rlc1xuICB2YXIgZnV0dXJlQ29kZXMgPSBmdXR1cmVIb3Vycy5tYXAoZnVuY3Rpb24gKGhvdXIpIHtcbiAgICByZXR1cm4gcGFyc2VJbnQoaG91ci5mY3Rjb2RlKTtcbiAgfSk7XG5cbiAgdmFyIG1heFByZWNpcFByb2IgPSBNYXRoLm1heC5hcHBseShNYXRoLCBfdG9Db25zdW1hYmxlQXJyYXkoZnV0dXJlUHJvYnMpKTtcbiAgdmFyIG1heEZvcmVjYXN0Q29kZSA9IE1hdGgubWF4LmFwcGx5KE1hdGgsIF90b0NvbnN1bWFibGVBcnJheShmdXR1cmVDb2RlcykpO1xuXG4gIGlmIChbMTAsIDEyLCAxNCwgMTgsIDIwLCAyMl0uaW5jbHVkZXMobWF4Rm9yZWNhc3RDb2RlKSkge1xuICAgIG1heEZvcmVjYXN0Q29kZSsrO1xuICB9XG5cbiAgLy8gbGV0IGljb24gPSBqc29uLmN1cnJlbnRfb2JzZXJ2YXRpb24uaWNvblxuXG4gIHZhciBmdXR1cmVEZXNjID0gZnVuY3Rpb24gKHByb2IpIHtcbiAgICBpZiAocHJvYiA+PSA4MC4wKSByZXR1cm4gJ0l0IHdpbGwgYmUgd2V0JztcbiAgICBpZiAoYmV0d2Vlbihwcm9iLCA0MC4wLCA4MC4wKSkgcmV0dXJuICdUaGVyZVxcJ3MgYSBnb29kIGNoYW5jZSBvZiBwcmVjaXBpdGF0aW9uJztcbiAgICBpZiAoYmV0d2Vlbihwcm9iLCAxMC4wLCA0MC4wKSkgcmV0dXJuICdUaGVyZVxcJ3MgYSBzbGlnaHQgY2hhbmNlIG9mIHByZWNpcGl0YXRpb24nO1xuICAgIHJldHVybiAnSXQgd2lsbCBiZSBkcnknO1xuICB9KG1heFByZWNpcFByb2IpO1xuXG4gIHZhciBjb25jYXRQcmVjaXAgPSBmdXR1cmVEZXNjO1xuICBjb25jYXRQcmVjaXAgKz0gJy4nO1xuXG4gIHJldHVybiB7IG1heEZvcmVjYXN0OiBtYXhGb3JlY2FzdENvZGUsIHN0cjogY29uY2F0UHJlY2lwIH07XG59XG5cbmV4cG9ydHMucGFyc2UgPSBmdW5jdGlvbiAoanNvbiwgaG91cnNBaGVhZCkge1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICB2YXIgd2VhdGhlckRhdGEgPSB7fTtcbiAgICB2YXIgaWNvbiA9IGpzb24uY3VycmVudF9vYnNlcnZhdGlvbi5pY29uX3VybC5tYXRjaCgvXFx3XFwvKFxcdyspLmdpZiQvKVsxXTtcblxuICAgIHdlYXRoZXJEYXRhLmxvYyA9IGpzb24uY3VycmVudF9vYnNlcnZhdGlvbi5kaXNwbGF5X2xvY2F0aW9uLmNpdHk7XG4gICAgd2VhdGhlckRhdGEuaWNvbiA9IGljb247XG4gICAgd2VhdGhlckRhdGEuZiA9IGpzb24uY3VycmVudF9vYnNlcnZhdGlvbi5mZWVsc2xpa2VfZjtcbiAgICB3ZWF0aGVyRGF0YS5jID0ganNvbi5jdXJyZW50X29ic2VydmF0aW9uLmZlZWxzbGlrZV9jO1xuICAgIHdlYXRoZXJEYXRhLnRlbXBTdHIgPSBmb3JtYXRUZW1wKGpzb24sIGhvdXJzQWhlYWQpO1xuICAgIHdlYXRoZXJEYXRhLndpbmRTdHIgPSBmb3JtYXRXaW5kKGpzb24sIGhvdXJzQWhlYWQpO1xuXG4gICAgdmFyIHByZWNpcE9iaiA9IGZvcm1hdFByZWNpcChqc29uLCBob3Vyc0FoZWFkKTtcbiAgICB3ZWF0aGVyRGF0YS5wcmVjaXBTdHIgPSBwcmVjaXBPYmouc3RyO1xuICAgIHdlYXRoZXJEYXRhLm1heEZvcmVjYXN0ID0gcHJlY2lwT2JqLm1heEZvcmVjYXN0O1xuXG4gICAgcmVzb2x2ZSh3ZWF0aGVyRGF0YSk7XG4gIH0pO1xufTtcbn0se31dLDU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgbG9jYXRpb24gPSByZXF1aXJlKCcuL2xvY2F0aW9uJyk7XG52YXIgcGFyc2VyID0gcmVxdWlyZSgnLi9wYXJzZXInKTtcbnZhciBpbmplY3RvciA9IHJlcXVpcmUoJy4vaW5qZWN0b3InKTtcblxuLy8gY2hlY2sgZm9yIGV4aXN0ZW5jZSBvZiBjb29raWVcbi8vIHRoZW4gc2V0IGl0IGVpdGhlciB0byB1c2VyIHByZWZlcmVuY2Ugb3IgOFxudmFyIGhvdXJzQWhlYWQgPSBkb2N1bWVudC5jb29raWUgPyBkb2N1bWVudC5jb29raWUubWF0Y2goL2hvdXJzPShcXGR7MSwyfSkvKVsxXSB8fCA4IDogODtcbnZhciBsb2FkaW5nU2NyZWVuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmctc2NyZWVuJyk7XG52YXIgcmVmcmVzaEljb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVmcmVzaC1pY29uJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKCkge1xuICBzaG93TG9hZGluZygpIC8vIGJlZ2luIHJlZnJlc2ggaWNvbiBzcGlubmluZ1xuICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGxvY2F0aW9uLmdldCgpO1xuICB9KSAvLyBsb2NhdGlvbiBpcyBzY3JhcGVkIGZyb20gdGhlIGJyb3dzZXJcbiAgLnRoZW4oZnVuY3Rpb24gKGxvYykge1xuICAgIHJldHVybiBsb2NhdGlvbi5zZW5kKGxvYyk7XG4gIH0pIC8vIHRoZW4gc2VudCB0byB0aGUgc2VydmVyXG4gIC50aGVuKGZ1bmN0aW9uIChqc29uKSB7XG4gICAgcmV0dXJuIHBhcnNlci5wYXJzZShqc29uLCBob3Vyc0FoZWFkKTtcbiAgfSkgLy8gc2VydmVyIHJlc3BvbnNlIGlzIHBhcnNlZFxuICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgIHJldHVybiBpbmplY3Rvci5pbmplY3QoZGF0YSwgaG91cnNBaGVhZCk7XG4gIH0pIC8vIHRoZW4gaW5qZWN0ZWQgaW50byB0aGUgRE9NXG4gIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gaGlkZUxvYWRpbmcoKTtcbiAgfSk7IC8vIHN0b3AgcmVmcmVzaCBpY29uIHNwaW5uaW5nIGFuZCBoaWRlIGxvYWQgc2NyZWVuXG59O1xuXG5mdW5jdGlvbiBzaG93TG9hZGluZygpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgcmVmcmVzaEljb24uY2xhc3NMaXN0LmFkZCgnYW5pbWF0ZS1zcGluJyk7XG4gICAgcmVzb2x2ZSgpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gaGlkZUxvYWRpbmcoKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgIC8vIGZhZGUgbG9hZGluZyBzY3JlZW5cbiAgICBsb2FkaW5nU2NyZWVuLmNsYXNzTGlzdC5hZGQoJ2FuaW1hdGUtZmFkZScpO1xuICAgIC8vIHN0b3AgcmVmcmVzaCBpY29uIGZyb20gc3Bpbm5pbmdcbiAgICByZWZyZXNoSWNvbi5jbGFzc0xpc3QucmVtb3ZlKCdhbmltYXRlLXNwaW4nKTtcbiAgICAvLyB1bmhpZGUgcmVmcmVzaCBvbiBmaXJzdCBsb2FkIG9ubHlcbiAgICBpZiAocmVmcmVzaEljb24uY2xhc3NMaXN0LmNvbnRhaW5zKCdoaWRkZW4nKSkge1xuICAgICAgcmVmcmVzaEljb24uY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG4gICAgfVxuICAgIHJlc29sdmUoKTtcbiAgfSk7XG59XG59LHtcIi4vaW5qZWN0b3JcIjoyLFwiLi9sb2NhdGlvblwiOjMsXCIuL3BhcnNlclwiOjR9XSw2OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuLyogZ2xvYmFsICQgKi9cblxudmFyICRzZXR0aW5nc0ljb24gPSAkKCcjc2V0dGluZ3MtaWNvbicpO1xudmFyICRzZXR0aW5nc01lbnUgPSAkKCcjc2V0dGluZ3MtbWVudScpO1xudmFyICR0ZW1wVG9nZ2xlID0gJCgnI3RlbXAtdG9nZ2xlJyk7XG52YXIgJHRvZ2dsZUl0ZW1zID0gJCgnLnRvZ2dsZS1pdGVtJyk7XG5cbnZhciAkdGVtcCA9ICQoJyN0ZW1wJyk7XG5cbi8vIHNob3cgb3IgaGlkZSBzZXR0aW5ncyBtZW51XG4kc2V0dGluZ3NJY29uLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgaWYgKHNldHRpbmdzQXJlVmlzaWJsZSgpKSB7XG4gICAgaGlkZVNldHRpbmdzKCk7XG4gIH0gZWxzZSB7XG4gICAgc2hvd1NldHRpbmdzKCk7XG4gIH1cbn0pO1xuXG4vLyBzZWxlY3QgdW5pdHMgb24gcGFnZSBsb2FkXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gIHZhciB0ZW1wUHJlZiA9IHZvaWQgMDtcbiAgdHJ5IHtcbiAgICB0ZW1wUHJlZiA9IGRvY3VtZW50LmNvb2tpZS5tYXRjaCgvdGVtcD0oZnxjKS8pWzFdO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGVtcFByZWYgPSAnZic7XG4gIH1cbiAgJCgnW2RhdGEtdW5pdHM9XFwnJyArIHRlbXBQcmVmICsgJ1xcJ10nKS5hZGRDbGFzcygnc2VsZWN0ZWQnKTtcbn0pO1xuXG4vLyB0b2dnbGUgdW5pdHNcbiR0b2dnbGVJdGVtcy5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICB2YXIgJHRhcmdldCA9ICQoZS50YXJnZXQpO1xuICAvLyBvbmx5IGRvIHNvbWV0aGluZyBpZiBzZWxlY3RpbmcgZGlmZmVyZW50IHVuaXRzXG4gIGlmIChvcHRpb25Jc05vdFNlbGVjdGVkKCR0YXJnZXQpKSB7XG4gICAgdmFyIHVuaXRzID0gJHRhcmdldC5hdHRyKCdkYXRhLXVuaXRzJyk7XG4gICAgJHRvZ2dsZUl0ZW1zLnRvZ2dsZUNsYXNzKCdzZWxlY3RlZCcpO1xuICAgIC8vIHJlc2V0IGNvb2tpZVxuICAgIGRvY3VtZW50LmNvb2tpZSA9ICd0ZW1wPScgKyB1bml0cztcbiAgICAvLyB0aGVuIHJlcGxhY2UgdGVtcCBpbiBET01cbiAgICAkdGVtcC50ZXh0KHdpbmRvdy53ZWF0aGVyW3VuaXRzXSArICcgwrAnICsgdW5pdHMudG9VcHBlckNhc2UoKSk7XG4gICAgaGlkZVNldHRpbmdzKCk7XG4gIH1cbn0pO1xuXG4vLyAtIGZ1bmN0aW9uIGRlZmluaXRpb25zXG5cbmZ1bmN0aW9uIHNldHRpbmdzQXJlVmlzaWJsZSgpIHtcbiAgcmV0dXJuICRzZXR0aW5nc01lbnUuY3NzKCdtYXgtaGVpZ2h0JykgIT09ICcwcHgnO1xufVxuXG5mdW5jdGlvbiBoaWRlU2V0dGluZ3MoKSB7XG4gICR0ZW1wVG9nZ2xlLmFuaW1hdGUoeyAnb3BhY2l0eSc6IDAgfSwgMjUwLCBmdW5jdGlvbiAoKSB7XG4gICAgJHNldHRpbmdzTWVudS5hbmltYXRlKHsgJ21heC1oZWlnaHQnOiAnMHB4JyB9LCA1MDApO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gc2hvd1NldHRpbmdzKCkge1xuICB2YXIgaWNvblJpZ2h0UG9zaXRpb24gPSAkc2V0dGluZ3NJY29uLnBvc2l0aW9uKCkubGVmdCArICRzZXR0aW5nc0ljb24ud2lkdGgoKTtcbiAgJHNldHRpbmdzTWVudS5jc3MoJ2xlZnQnLCBpY29uUmlnaHRQb3NpdGlvbiAtICRzZXR0aW5nc01lbnUud2lkdGgoKSk7XG4gICRzZXR0aW5nc01lbnUuYW5pbWF0ZSh7ICdtYXgtaGVpZ2h0JzogJzEwMHB4JyB9LCA1MDAsIGZ1bmN0aW9uICgpIHtcbiAgICAkdGVtcFRvZ2dsZS5hbmltYXRlKHsgJ29wYWNpdHknOiAxIH0sIDI1MCk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBvcHRpb25Jc05vdFNlbGVjdGVkKHRhcmdldCkge1xuICAvLyB0YXJnZXQgc2hvdWxkIGJlIGpRdWVyeSBvYmplY3RcbiAgcmV0dXJuICF0YXJnZXQuaGFzQ2xhc3MoJ3NlbGVjdGVkJyk7XG59XG59LHt9XX0se30sWzFdKSJdfQ==
